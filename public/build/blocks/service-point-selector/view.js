(()=>{"use strict";var e,t={496:(e,t,n)=>{const o=window.wc.blocksCheckout,s=window.wc.wcBlocksData,r=window.wp.element,i=window.wp.data,a=window.wp.i18n,l=window.wp.apiFetch;var c=n.n(l),d=n(848);function u({servicePoints:e,onSelect:t,selectedServicePoint:n}){return(0,d.jsx)("div",{className:"service_points_dropdown",children:e.map((e=>(0,d.jsxs)("div",{className:"service_point"+(n&&n.id===e.id?" selected":""),onClick:()=>t(e),children:[(0,d.jsx)("div",{className:"header",children:(0,d.jsx)("span",{className:"name",children:e.name})}),(0,d.jsxs)("div",{className:"location",children:[(0,d.jsx)("div",{className:"address_info",children:(0,a.sprintf)((0,a._x)("%1$s, %2$s %3$s","Address display: %1$s - street and number, %2$s zipcode and %3$s city","pakkelabels-for-woocommerce"),e.address,e.zipcode,e.city)}),(0,d.jsx)("div",{className:"distance",children:(0,a.sprintf)((0,a._x)("%s km","Distance display","pakkelabels-for-woocommerce"),parseFloat((e.distance/1e3).toFixed(2)))})]})]},e.id)))})}function p({onClose:e}){return(0,d.jsx)("button",{className:"shipmondo-modal_close",onClick:t=>{t.preventDefault(),e()},children:(0,d.jsx)("span",{"aria-hidden":"true",children:"Ã—"})})}function m({servicePoints:e,onSelect:t,selectedServicePoint:n}){return(0,d.jsx)("div",{className:"service_points_list",children:e.map((e=>(0,d.jsxs)("div",{className:"service_point"+(n&&n.id===e.id?" selected":""),onClick:()=>t(e),children:[(0,d.jsx)("div",{className:"header",children:(0,d.jsx)("span",{className:"name",children:e.name})}),(0,d.jsxs)("div",{className:"location",children:[(0,d.jsx)("div",{className:"address_info",children:(0,a.sprintf)((0,a._x)("%1$s, %2$s %3$s","Address display: %1$s - street and number, %2$s zipcode and %3$s city","pakkelabels-for-woocommerce"),e.address,e.zipcode,e.city)}),(0,d.jsx)("div",{className:"distance",children:(0,a.sprintf)((0,a._x)("%s km","Distance display","pakkelabels-for-woocommerce"),parseFloat((e.distance/1e3).toFixed(2)))})]})]},e.id)))})}var f=n(609);const g=window.ReactDOM;var h=n(17);function v(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}function b(){return b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},b.apply(this,arguments)}function _(e,t){if(null==e)return{};var n,o,s={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(s[n]=e[n]);return s}const w={NOT_LOADED:"NOT_LOADED",LOADING:"LOADING",LOADED:"LOADED",FAILED:"FAILED",AUTH_FAILURE:"AUTH_FAILURE"};class y{static async load(e,t){var n;const o=e.libraries?e.libraries.split(","):[],s=this.serializeParams(e);this.listeners.push(t),null!=(n=window.google)&&null!=(n=n.maps)&&n.importLibrary?(this.serializedApiParams||(this.loadingStatus=w.LOADED),this.notifyLoadingStatusListeners()):(this.serializedApiParams=s,this.initImportLibrary(e)),this.serializedApiParams&&this.serializedApiParams!==s&&console.warn("[google-maps-api-loader] The maps API has already been loaded with different parameters and will not be loaded again. Refresh the page for new values to have effect.");const r=["maps",...o];await Promise.all(r.map((e=>google.maps.importLibrary(e))))}static serializeParams(e){return[e.v,e.key,e.language,e.region,e.authReferrerPolicy,e.solutionChannel].join("/")}static initImportLibrary(e){if(window.google||(window.google={}),window.google.maps||(window.google.maps={}),window.google.maps.importLibrary)return void console.error("[google-maps-api-loader-internal]: initImportLibrary must only be called once");let t=null;const n=()=>t||(t=new Promise(((t,n)=>{var o;const s=document.createElement("script"),r=new URLSearchParams;for(const[t,n]of Object.entries(e)){const e=t.replace(/[A-Z]/g,(e=>"_"+e[0].toLowerCase()));r.set(e,n)}r.set("loading","async"),r.set("callback","__googleMapsCallback__"),s.async=!0,s.src="https://maps.googleapis.com/maps/api/js?"+r.toString(),s.nonce=(null==(o=document.querySelector("script[nonce]"))?void 0:o.nonce)||"",s.onerror=()=>{this.loadingStatus=w.FAILED,this.notifyLoadingStatusListeners(),n(new Error("The Google Maps JavaScript API could not load."))},window.__googleMapsCallback__=()=>{this.loadingStatus=w.LOADED,this.notifyLoadingStatusListeners(),t()},window.gm_authFailure=()=>{this.loadingStatus=w.AUTH_FAILURE,this.notifyLoadingStatusListeners()},this.loadingStatus=w.LOADING,this.notifyLoadingStatusListeners(),document.head.append(s)})),t);google.maps.importLibrary=e=>n().then((()=>google.maps.importLibrary(e)))}static notifyLoadingStatusListeners(){for(const e of this.listeners)e(this.loadingStatus)}}y.loadingStatus=w.NOT_LOADED,y.serializedApiParams=void 0,y.listeners=[];const k=["onLoad","apiKey","version","libraries"],S=["children"],x=f.createContext(null),E=e=>{const{children:t}=e,n=_(e,S),{mapInstances:o,addMapInstance:s,removeMapInstance:r,clearMapInstances:i}=function(){const[e,t]=(0,f.useState)({});return{mapInstances:e,addMapInstance:(e,n="default")=>{t((t=>b({},t,{[n]:e})))},removeMapInstance:(e="default")=>{t((t=>_(t,[e].map(v))))},clearMapInstances:()=>{t({})}}}(),{status:a,loadedLibraries:l,importLibrary:c}=function(e){const{onLoad:t,apiKey:n,version:o,libraries:s=[]}=e,r=_(e,k),[i,a]=(0,f.useState)(y.loadingStatus),[l,c]=(0,f.useReducer)(((e,t)=>b({},e,{[t.name]:t.value})),{}),d=(0,f.useMemo)((()=>null==s?void 0:s.join(",")),[s]),u=(0,f.useMemo)((()=>JSON.stringify(b({apiKey:n,version:o},r))),[n,o,r]),p=(0,f.useCallback)((async e=>{var t;if(l[e])return l[e];if(null==(t=google)||null==(t=t.maps)||!t.importLibrary)throw new Error("[api-provider-internal] importLibrary was called before google.maps.importLibrary was defined.");const n=await window.google.maps.importLibrary(e);return c({name:e,value:n}),n}),[l]);return(0,f.useEffect)((()=>{(async()=>{try{const e=b({key:n},r);o&&(e.v=o),(null==d?void 0:d.length)>0&&(e.libraries=d),await y.load(e,(e=>a(e)));for(const e of["core","maps",...s])await p(e);t&&t()}catch(e){console.error("<ApiProvider> failed to load Google Maps API",e)}})()}),[n,d,u]),{status:i,loadedLibraries:l,importLibrary:p}}(n),d=(0,f.useMemo)((()=>({mapInstances:o,addMapInstance:s,removeMapInstance:r,clearMapInstances:i,status:a,loadedLibraries:l,importLibrary:c})),[o,s,r,i,a,l,c]);return f.createElement(x.Provider,{value:d},t)};function j(e,t,n){const o={type:e,map:t,detail:{},stoppable:!1,stop:()=>{}};if(O.includes(e)){const e=o,n=t.getCenter(),s=t.getZoom(),r=t.getHeading()||0,i=t.getTilt()||0,a=t.getBounds();return n&&a&&Number.isFinite(s)||console.warn("[createEvent] at least one of the values from the map returned undefined. This is not expected to happen. Please report an issue at https://github.com/visgl/react-google-maps/issues/new"),e.detail={center:(null==n?void 0:n.toJSON())||{lat:0,lng:0},zoom:s||0,heading:r,tilt:i,bounds:(null==a?void 0:a.toJSON())||{north:90,east:180,south:-90,west:-180}},e}if(L.includes(e)){var s;if(!n)throw new Error("[createEvent] mouse events must provide a srcEvent");const e=o;return e.domEvent=n.domEvent,e.stoppable=!0,e.stop=()=>n.stop(),e.detail={latLng:(null==(s=n.latLng)?void 0:s.toJSON())||null,placeId:n.placeId},e}return o}const C={onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onContextmenu:"contextmenu",onDblclick:"dblclick",onDrag:"drag",onDragend:"dragend",onDragstart:"dragstart",onHeadingChanged:"heading_changed",onIdle:"idle",onIsFractionalZoomEnabledChanged:"isfractionalzoomenabled_changed",onMapCapabilitiesChanged:"mapcapabilities_changed",onMapTypeIdChanged:"maptypeid_changed",onMousemove:"mousemove",onMouseout:"mouseout",onMouseover:"mouseover",onProjectionChanged:"projection_changed",onRenderingTypeChanged:"renderingtype_changed",onTilesLoaded:"tilesloaded",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed",onCameraChanged:"bounds_changed"},O=["bounds_changed","center_changed","heading_changed","projection_changed","tilt_changed","zoom_changed"],L=["click","contextmenu","dblclick","mousemove","mouseout","mouseover"],N=Object.keys(C),P=new Set(["backgroundColor","clickableIcons","controlSize","disableDefaultUI","disableDoubleClickZoom","draggable","draggableCursor","draggingCursor","fullscreenControl","fullscreenControlOptions","gestureHandling","isFractionalZoomEnabled","keyboardShortcuts","mapTypeControl","mapTypeControlOptions","mapTypeId","maxZoom","minZoom","noClear","panControl","panControlOptions","restriction","rotateControl","rotateControlOptions","scaleControl","scaleControlOptions","scrollwheel","streetView","streetViewControl","streetViewControlOptions","styles","zoomControl","zoomControlOptions"]);function I(e,t){const n={},o=Object.keys(t);for(const e of o)P.has(e)&&(n[e]=t[e]);!function(t,o){const s=(0,f.useRef)(void 0);s.current&&h(o,s.current)||(s.current=o),(0,f.useEffect)((()=>{e&&e.setOptions(n)}),s.current)}(0,[n])}function D(){var e;return(null==(e=(0,f.useContext)(x))?void 0:e.status)||w.NOT_LOADED}function A(e){return function(e){return!(!e||"object"!=typeof e)&&"lat"in e&&"lng"in e&&Number.isFinite(e.lat)&&Number.isFinite(e.lng)}(e)?e:e.toJSON()}const F=()=>f.createElement("div",{style:{position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:999,display:"flex",flexFlow:"column nowrap",textAlign:"center",justifyContent:"center",fontSize:".8rem",color:"rgba(0,0,0,0.6)",background:"#dddddd",padding:"1rem 1.5rem"}},f.createElement("h2",null,"Error: AuthFailure"),f.createElement("p",null,"A problem with your API key prevents the map from rendering correctly. Please make sure the value of the ",f.createElement("code",null,"APIProvider.apiKey")," prop is correct. Check the error-message in the console for further details."));function M(){return D()===w.LOADED}const T=["id","defaultBounds","defaultCenter","defaultZoom","defaultHeading","defaultTilt"];function z(e,t){const n=M(),[o,s]=(0,f.useState)(null),[r,i]=function(){const[e,t]=(0,f.useState)(null);return[e,(0,f.useCallback)((e=>t(e)),[t])]}(),a=function(e){const t=function(){const[,e]=(0,f.useReducer)((e=>e+1),0);return e}(),n=(0,f.useRef)({center:{lat:0,lng:0},heading:0,tilt:0,zoom:0});return(0,f.useEffect)((()=>{if(!e)return;const o=google.maps.event.addListener(e,"bounds_changed",(()=>{!function(e,t){const n=e.getCenter(),o=e.getZoom(),s=e.getHeading()||0,r=e.getTilt()||0,i=e.getBounds();n&&i&&Number.isFinite(o)||console.warn("[useTrackedCameraState] at least one of the values from the map returned undefined. This is not expected to happen. Please report an issue at https://github.com/visgl/react-google-maps/issues/new"),Object.assign(t.current,{center:(null==n?void 0:n.toJSON())||{lat:0,lng:0},zoom:o||0,heading:s,tilt:r})}(e,n),t()}));return()=>o.remove()}),[e,t]),n}(o),{id:l,defaultBounds:c,defaultCenter:d,defaultZoom:u,defaultHeading:p,defaultTilt:m}=e,g=_(e,T),h=void 0!==e.zoom||void 0!==e.defaultZoom,v=void 0!==e.center||void 0!==e.defaultCenter;c||h&&v||console.warn("<Map> component is missing configuration. You have to provide zoom and center (via the `zoom`/`defaultZoom` and `center`/`defaultCenter` props) or specify the region to show using `defaultBounds`. See https://visgl.github.io/react-google-maps/docs/api-reference/components/map#required"),!g.center&&d&&(g.center=d),!g.zoom&&Number.isFinite(u)&&(g.zoom=u),!g.heading&&Number.isFinite(p)&&(g.heading=p),!g.tilt&&Number.isFinite(m)&&(g.tilt=m);for(const e of Object.keys(g))void 0===g[e]&&delete g[e];const b=(0,f.useRef)();return(0,f.useEffect)((()=>{if(!r||!n)return;const{addMapInstance:o,removeMapInstance:i}=t,d=e.mapId,u=new google.maps.Map(r,g);if(s(u),o(u,l),c?u.fitBounds(c):h&&v||u.fitBounds({east:180,west:-180,south:-90,north:90}),b.current){const{mapId:e,cameraState:t}=b.current;e!==d&&u.setOptions(t)}return()=>{b.current={mapId:d,cameraState:a.current},google.maps.event.clearInstanceListeners(u),s(null),i(l)}}),[r,n,l,e.mapId]),[o,i,a]}const R=f.createContext(null),$=e=>{const{children:t,id:n,className:o,style:s}=e,r=(0,f.useContext)(x),i=D();if(!r)throw new Error("<Map> can only be used inside an <ApiProvider> component.");const[a,l,c]=z(e,r);!function(e,t,n){const o=n.center?A(n.center):null;let s=null,r=null;o&&Number.isFinite(o.lat)&&Number.isFinite(o.lng)&&(s=o.lat,r=o.lng);const i=Number.isFinite(n.zoom)?n.zoom:null,a=Number.isFinite(n.heading)?n.heading:null,l=Number.isFinite(n.tilt)?n.tilt:null;(0,f.useLayoutEffect)((()=>{if(!e)return;const n={};let o=!1;null===s||null===r||t.current.center.lat===s&&t.current.center.lng===r||(n.center={lat:s,lng:r},o=!0),null!==i&&t.current.zoom!==i&&(n.zoom=i,o=!0),null!==a&&t.current.heading!==a&&(n.heading=a,o=!0),null!==l&&t.current.tilt!==l&&(n.tilt=l,o=!0),o&&e.moveCamera(n)}))}(a,c,e),function(e,t){for(const n of N){const o=t[n],s=C[n];(0,f.useEffect)((()=>{if(!e)return;if(!o)return;const t=google.maps.event.addListener(e,s,(t=>{o(j(s,e,t))}));return()=>t.remove()}),[e,s,o])}}(a,e),I(a,e);const d=function(e,t){const{viewport:n,viewState:o}=t,s=!!n;return(0,f.useLayoutEffect)((()=>{if(!e||!o)return;const{latitude:t,longitude:n,bearing:s,pitch:r,zoom:i}=o;e.moveCamera({center:{lat:t,lng:n},heading:s,tilt:r,zoom:i+1})}),[e,o]),s}(a,e),u=!!e.controlled;(0,f.useEffect)((()=>{if(a)return d&&a.setOptions({disableDefaultUI:!0}),(d||u)&&a.setOptions({gestureHandling:"none",keyboardShortcuts:!1}),()=>{a.setOptions({gestureHandling:e.gestureHandling,keyboardShortcuts:e.keyboardShortcuts})}}),[a,d,u,e.gestureHandling,e.keyboardShortcuts]);const p=e.center?A(e.center):null;let m=null,g=null;p&&Number.isFinite(p.lat)&&Number.isFinite(p.lng)&&(m=p.lat,g=p.lng);const h=(0,f.useMemo)((()=>{var t,n,o,s,r;return{center:{lat:null!=(t=m)?t:0,lng:null!=(n=g)?n:0},zoom:null!=(o=e.zoom)?o:0,heading:null!=(s=e.heading)?s:0,tilt:null!=(r=e.tilt)?r:0}}),[m,g,e.zoom,e.heading,e.tilt]);(0,f.useLayoutEffect)((()=>{if(!a||!u)return;a.moveCamera(h);const e=a.addListener("bounds_changed",(()=>{a.moveCamera(h)}));return()=>e.remove()}),[a,u,h]);const v=(0,f.useMemo)((()=>b({width:"100%",height:"100%",zIndex:d?-1:0},s)),[s,d]),_=(0,f.useMemo)((()=>({map:a})),[a]);return i===w.AUTH_FAILURE?f.createElement("div",{style:b({position:"relative"},o?{}:v),className:o},f.createElement(F,null)):f.createElement("div",b({ref:l,"data-testid":"map",style:o?void 0:v,className:o},n?{id:n}:{}),a?f.createElement(R.Provider,{value:_},t):null)};$.deckGLViewProps=!0;const U=new Set;const H=(e=null)=>{const t=(0,f.useContext)(x),{map:n}=(0,f.useContext)(R)||{};if(null===t)return function(...e){const t=JSON.stringify(e);U.has(t)||(U.add(t),console.error(...e))}("useMap(): failed to retrieve APIProviderContext. Make sure that the <APIProvider> component exists and that the component you are calling `useMap()` from is a sibling of the <APIProvider>."),null;const{mapInstances:o}=t;return null!==e?o[e]||null:n||o.default||null};function B(e){const t=M(),n=(0,f.useContext)(x);return(0,f.useEffect)((()=>{t&&n&&n.importLibrary(e)}),[t,n,e]),(null==n?void 0:n.loadedLibraries[e])||null}const Z=f.createContext(null),K=(0,f.forwardRef)(((e,t)=>{const{children:n}=e,[o,s]=function(e){const[t,n]=(0,f.useState)(null),[o,s]=(0,f.useState)(null),r=H(),i=B("marker"),{children:a,className:l,onClick:c,onDrag:d,onDragStart:u,onDragEnd:p,collisionBehavior:m,draggable:g,position:h,title:v,zIndex:b}=e,_=f.Children.count(a);return(0,f.useEffect)((()=>{if(!r||!i)return;const e=new i.AdvancedMarkerElement;if(e.map=r,n(e),_>0){const t=document.createElement("div");l&&(t.className=l),e.content=t,s(t)}return()=>{e.map=null,n(null),s(null)}}),[r,i,_]),(0,f.useEffect)((()=>{o&&(o.className=null!=l?l:"")}),[o,l]),(0,f.useEffect)((()=>{if(!t)return;const e=google.maps.event;c&&e.addListener(t,"click",c),d&&e.addListener(t,"drag",d),u&&e.addListener(t,"dragstart",u),p&&e.addListener(t,"dragend",p),(d||u||p)&&!g&&console.warn("You need to set the marker to draggable to listen to drag-events.");const n=t;return()=>{e.clearInstanceListeners(n)}}),[t,g,c,u,d,p]),(0,f.useEffect)((()=>{t&&(void 0!==h&&(t.position=h),void 0!==g&&(t.gmpDraggable=g),void 0!==m&&(t.collisionBehavior=m),void 0!==b&&(t.zIndex=b),"string"==typeof v&&(t.title=v))}),[t,h,g,m,b,v]),[t,o]}(e),r=(0,f.useMemo)((()=>o?{marker:o}:null),[o]);return(0,f.useImperativeHandle)(t,(()=>o),[o]),o?f.createElement(Z.Provider,{value:r},null!==s&&(0,g.createPortal)(n,s)):null})),V=["children","anchor","shouldFocus","onCloseClick"],J=e=>{const{children:t,anchor:n,shouldFocus:o,onCloseClick:s}=e,r=_(e,V),i=H(),a=(0,f.useRef)(null),[l,c]=(0,f.useState)(null);return(0,f.useEffect)((()=>{if(!i)return;const e=new google.maps.InfoWindow(r),t=document.createElement("div");return e.setContent(t),a.current=e,c(t),()=>{google.maps.event.clearInstanceListeners(e),e.close(),t.remove(),c(null)}}),[i,t]),(0,f.useEffect)((()=>{var e;null==(e=a.current)||e.setOptions(r)}),[r]),(0,f.useEffect)((()=>{if(!a.current)return;let e=null;return s&&(e=google.maps.event.addListener(a.current,"closeclick",s)),()=>{e&&e.remove()}}),[s]),(0,f.useEffect)((()=>{if(!l||!a.current||null===n)return;const e={map:i};n&&(e.anchor=n),void 0!==o&&(e.shouldFocus=o),a.current.open(e)}),[l,a,n,i,o]),f.createElement(f.Fragment,null,null!==l&&(0,g.createPortal)(t,l))},W=["onClick","onDrag","onDragStart","onDragEnd","onMouseOver","onMouseOut"];function Y({servicePoint:e,onSelect:t,onToggleInfoWindow:n,isInfoWindowOpen:o,iconUrl:s}){const[r,i]=function(){const[e,t]=(0,f.useState)(null);return[(0,f.useCallback)((e=>{t(e)}),[]),e]}();return(0,d.jsxs)(K,{position:{lat:e.latitude,lng:e.longitude},onClick:()=>n(!o),ref:r,children:[(0,d.jsx)("img",{src:s,width:"48px",height:"48px"}),o?(0,d.jsx)(J,{anchor:i,maxWidth:300,minWidth:200,onCloseClick:()=>n(!1),children:(0,d.jsxs)("div",{className:"shipmondo-modal-map_info-window",children:[(0,d.jsx)("div",{className:"header",children:(0,d.jsx)("span",{className:"name",children:e.name})}),(0,d.jsxs)("div",{className:"location",children:[(0,d.jsx)("div",{className:"address_info",children:(0,a.sprintf)((0,a._x)("%1$s, %2$s %3$s","Address display: %1$s - street and number, %2$s zipcode and %3$s city","pakkelabels-for-woocommerce"),e.address,e.zipcode,e.city)}),(0,d.jsx)("div",{className:"distance",children:(0,a.sprintf)((0,a._x)("%s km","Distance display","pakkelabels-for-woocommerce"),parseFloat((e.distance/1e3).toFixed(2)))})]}),(0,d.jsx)("button",{className:"button",onClick:()=>t(e),children:(0,a.__)("Select","pakkelabels-for-woocommerce")})]},e.id)}):null]},e.id)}function G({servicePoints:e,onSelect:t,selectedServicePoint:n,iconUrl:o,iconUrlSelected:s}){const i=B("core"),a=H(),[l,c]=(0,r.useState)(null);return(0,r.useEffect)((()=>{if(!i||!a)return;const t=new i.LatLngBounds;e.forEach((e=>{t.extend(new i.LatLng(e.latitude,e.longitude))})),a.fitBounds(t)}),[e,a,i]),(0,d.jsx)(d.Fragment,{children:e.map((e=>(0,d.jsx)(Y,{isInfoWindowOpen:l===e.id,onToggleInfoWindow:t=>c(t?e.id:null),servicePoint:e,onSelect:t,iconUrl:n&&n.id===e.id?s:o},e.id)))})}function q({servicePoints:e,onSelect:t,selectedServicePoint:n,mapsSettings:o}){return(0,d.jsx)("div",{className:"service_points_map",children:(0,d.jsx)(E,{apiKey:o.google_maps_api_key,libraries:["marker"],children:(0,d.jsx)($,{defaultCenter:{lat:55.394729,lng:10.383394},defaultZoom:10,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1,region:o.store_country,gestureHandling:"greedy",mapId:"shipmondo-service-point-selector-map",children:(0,d.jsx)(G,{servicePoints:e,onSelect:t,selectedServicePoint:n,iconUrl:o.maps_icon,iconUrlSelected:o.maps_icon_selected})})})})}function Q({servicePoints:e,onSelect:t,onClose:n,selectedServicePoint:o,mapsSettings:s}){(0,r.useEffect)((()=>(document.body.classList.add("shipmondo_modal_open"),()=>{document.body.classList.remove("shipmondo_modal_open")})));const i=(0,r.useRef)(),l=e=>{i.current.contains(e.target)||n()};return(0,r.useEffect)((()=>(document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}))),(0,d.jsx)("div",{className:"service_points_modal",children:(0,d.jsx)("div",{className:"shipmondo-modal_wrapper",ref:i,children:(0,d.jsxs)("div",{className:"shipmondo-modal_content",children:[(0,d.jsx)(p,{onClose:n}),(0,d.jsx)("div",{className:"shipmondo-modal_header",children:(0,d.jsx)("h4",{children:(0,a._x)("Select service point","Modal header","pakkelabels-for-woocommerce")})}),(0,d.jsx)(q,{servicePoints:e,onSelect:t,selectedServicePoint:o,mapsSettings:s}),(0,d.jsx)(m,{servicePoints:e,onSelect:t,selectedServicePoint:o}),(0,d.jsx)("div",{className:"shipmondo-modal_footer",children:(0,d.jsx)("div",{className:"powered_by_shipmondo",children:(0,d.jsx)("p",{children:(0,a.__)("Powered by Shipmondo","pakkelabels-for-woocommerce")})})})]})})})}(0,f.forwardRef)(((e,t)=>{const n=function(e){const[t,n]=(0,f.useState)(null),o=H(),{onClick:s,onDrag:r,onDragStart:i,onDragEnd:a,onMouseOver:l,onMouseOut:c}=e,d=_(e,W),{position:u,draggable:p}=d;return(0,f.useEffect)((()=>{if(!o)return void(void 0===o&&console.error("<Marker> has to be inside a Map component."));const e=new google.maps.Marker(d);return e.setMap(o),n(e),()=>{e.setMap(null),n(null)}}),[o]),(0,f.useEffect)((()=>{if(!t)return;const e=t,n=google.maps.event;return s&&n.addListener(e,"click",s),r&&n.addListener(e,"drag",r),i&&n.addListener(e,"dragstart",i),a&&n.addListener(e,"dragend",a),l&&n.addListener(e,"mouseover",l),c&&n.addListener(e,"mouseout",c),t.setDraggable(Boolean(p)),()=>{n.clearInstanceListeners(e)}}),[t,p,s,r,i,a,l,c]),(0,f.useEffect)((()=>{t&&d&&t.setOptions(d)}),[t,d]),(0,f.useEffect)((()=>{!p&&u&&t&&t.setPosition(u)}),[p,u,t]),t}(e);return(0,f.useImperativeHandle)(t,(()=>n),[n]),f.createElement(f.Fragment,null)}));const X=window.wc.wcSettings;function ee({shippingPackage:e,checkoutExtensionData:t,displayPackageTitle:n=!1}){var o,l,p;const m=e.shipping_rates.find((e=>e.selected)),f="shipmondo"===m.method_id&&void 0!==m.meta_data.find((e=>"is_service_point_delivery"===e.key&&e.value)),g=null!==(o=m.meta_data.find((e=>"shipping_agent"===e.key))?.value)&&void 0!==o?o:null,[h,v]=(0,r.useState)([]),[b,_]=(0,r.useState)(null!==(l=sessionStorage.getItem("shipmondo_selected_service_point"))&&void 0!==l?l:null),[w,y]=(0,r.useState)(null),k=e=>{_(e.id),y(e),N(!1)};(0,r.useEffect)((()=>{b&&sessionStorage.setItem("shipmondo_selected_service_point",b)}),[b]);const{setValidationErrors:S,clearValidationError:x}=(0,i.useDispatch)(s.VALIDATION_STORE_KEY);(0,r.useEffect)((()=>{!f||w?x("shipmondo_service_point"):S({shipmondo_service_point:{message:(0,a.__)("Please select a service point","pakkelabels-for-woocommerce"),hidden:!0}})}),[w]);const{getValidationError:E}=(0,i.useSelect)((e=>e(s.VALIDATION_STORE_KEY)),[]),j=E("shipmondo_service_point"),[C,O]=(0,r.useState)(!1),[L,N]=(0,r.useState)(!1),P=(0,i.useSelect)((e=>e(s.CHECKOUT_STORE_KEY).getExtensionData()),[]),{setExtensionData:I}=t;(0,r.useEffect)((()=>{(async()=>{f&&""!==e.destination.postcode?(O(!0),c()({path:"shipmondo/v1/service-points",method:"POST",data:{agent:g,address:e.destination.address_1,zipcode:e.destination.postcode,country:e.destination.country},parse:!1}).then((e=>{if(200===e.status)return e.json()})).then((e=>{v(e),O(!1)}))):v([])})()}),[e.destination,g]);const D=(0,i.useSelect)((e=>e(s.CART_STORE_KEY).isShippingRateBeingSelected()),!1);(0,r.useEffect)((()=>{O(D)}),[D]),(0,r.useEffect)((()=>{C&&N(!1)}),[C]),(0,r.useEffect)((()=>{b&&void 0!==h.find((e=>b===e.id))?y(h.find((e=>b===e.id))):P&&P[e.package_id]&&void 0!==h.find((t=>P[e.package_id].id===t.id))?y(P[e.package_id]):y(h[0])}),[h]),(0,r.useEffect)((()=>{w&&I("shipmondo","selected_service_points",{...P?.shipmondo?.selected_service_points||{},[e.package_id]:w})}),[w]);const A=(0,X.getSetting)("shipmondo-service-point-selector_data");if(!f||!g)return null;const F=null!==(p=A.selector_type)&&void 0!==p?p:"dropdown";let M=null;return"dropdown"===F?M=(0,d.jsx)(u,{servicePoints:h,selectedServicePoint:w,onSelect:k}):"modal"===F&&(M=(0,d.jsx)(Q,{servicePoints:h,selectedServicePoint:w,onSelect:k,onClose:()=>N(!1),mapsSettings:A.maps_settings})),(0,d.jsxs)("div",{className:"shipmondo_service_point_selection",children:[(0,d.jsxs)("h3",{className:"service_point_title",children:[(0,a.__)("Service Point","pakkelabels-for-woocommerce"),n?" - "+e.name:null]}),(0,d.jsx)("div",{className:"selected_service_point service_point "+F+(C?" loading":"")+(L?" selector_open":"")+(0===h.length?" no_service_point":"")+(!j||j.hidden?"":" has-error"),onClick:()=>{h.length>0?N(!L):N(!1)},children:w?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"header",children:[(0,d.jsx)("span",{className:"name",children:w.name}),(0,d.jsx)("span",{className:"rate_name",children:m.name})]}),(0,d.jsxs)("div",{className:"location",children:[(0,d.jsx)("div",{className:"address_info",children:(0,a.sprintf)((0,a._x)("%1$s, %2$s %3$s","Address display: %1$s - street and number, %2$s zipcode and %3$s city","pakkelabels-for-woocommerce"),w.address,w.zipcode,w.city)}),(0,d.jsx)("div",{className:"distance",children:(0,a.sprintf)((0,a._x)("%s km","Distance display","pakkelabels-for-woocommerce"),parseFloat((w.distance/1e3).toFixed(2)))})]})]}):(0,d.jsx)(d.Fragment,{children:""===e.destination.postcode?(0,d.jsx)(d.Fragment,{children:(0,a.__)("Please enter the shipping address to see available service points","pakkelabels-for-woocommerce")}):(0,d.jsx)(d.Fragment,{children:(0,a.__)("No service point available","pakkelabels-for-woocommerce")})})}),h&&L?M:null,!j||j.hidden?null:(0,d.jsx)("div",{className:"wc-block-components-validation-error",children:(0,d.jsx)("p",{children:j?.message})}),(0,d.jsx)("div",{className:"powered_by_shipmondo",children:(0,d.jsx)("p",{children:(0,a.__)("Powered by Shipmondo","pakkelabels-for-woocommerce")})})]})}const te=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"shipmondo/service-point-selector","version":"1.0.0","title":"Shipmondo Service Point Selector","category":"woocommerce","icon":"location","description":"Selector for shipping service point, when using a compatible Shipmondo shipping method.","supports":{"html":false,"align":false,"multiple":false,"reusable":false},"parent":["woocommerce/checkout-shipping-methods-block"],"attributes":{"lock":{"type":"object","default":{"remove":true,"move":true}}},"textdomain":"shipmondo","style":"file:./style-view.css","viewScript":"file:./view.js","editorScript":"file:./edit.php"}');(0,o.registerCheckoutBlock)({metadata:te,component:({checkoutExtensionData:e,extensions:t})=>{const n=(0,i.useSelect)(s.CART_STORE_KEY).getShippingRates(),[o,a]=(0,r.useState)([]);return(0,r.useEffect)((()=>{let e=[];n.forEach((t=>{e.push(t)})),t.subscriptions?.forEach((t=>{t.shipping_rates.forEach((t=>{e.push(t)}))})),a(e)}),[n,t?.subscriptions]),(0,d.jsx)(d.Fragment,{children:o.map((t=>(0,d.jsx)(ee,{shippingPackage:t,checkoutExtensionData:e,displayPackageTitle:o.length>1},t.package_id)))})}})},17:e=>{e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var o,s,r;if(Array.isArray(t)){if((o=t.length)!=n.length)return!1;for(s=o;0!=s--;)if(!e(t[s],n[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((o=(r=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(s=o;0!=s--;)if(!Object.prototype.hasOwnProperty.call(n,r[s]))return!1;for(s=o;0!=s--;){var i=r[s];if(!e(t[i],n[i]))return!1}return!0}return t!=t&&n!=n}},20:(e,t,n)=>{var o=n(609),s=Symbol.for("react.element"),r=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,a=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var o,r={},c=null,d=null;for(o in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)i.call(t,o)&&!l.hasOwnProperty(o)&&(r[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===r[o]&&(r[o]=t[o]);return{$$typeof:s,type:e,key:c,ref:d,props:r,_owner:a.current}}t.Fragment=r,t.jsx=c,t.jsxs=c},848:(e,t,n)=>{e.exports=n(20)},609:e=>{e.exports=window.React}},n={};function o(e){var s=n[e];if(void 0!==s)return s.exports;var r=n[e]={exports:{}};return t[e](r,r.exports,o),r.exports}o.m=t,e=[],o.O=(t,n,s,r)=>{if(!n){var i=1/0;for(d=0;d<e.length;d++){for(var[n,s,r]=e[d],a=!0,l=0;l<n.length;l++)(!1&r||i>=r)&&Object.keys(o.O).every((e=>o.O[e](n[l])))?n.splice(l--,1):(a=!1,r<i&&(i=r));if(a){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[n,s,r]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={27:0,235:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var s,r,[i,a,l]=n,c=0;if(i.some((t=>0!==e[t]))){for(s in a)o.o(a,s)&&(o.m[s]=a[s]);if(l)var d=l(o)}for(t&&t(n);c<i.length;c++)r=i[c],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(d)},n=globalThis.webpackChunkshipmondo_for_woocommerce=globalThis.webpackChunkshipmondo_for_woocommerce||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var s=o.O(void 0,[235],(()=>o(496)));s=o.O(s)})();